<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Marks Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
        }
        input {
            margin: 5px;
            padding: 5px;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .delete-btn {
            background-color: red;
            color: white;
            padding: 5px 10px;
            border: none;
            cursor: pointer;
        }
        .delete-btn:hover {
            background-color: #cc0000;
        }
        .highlight {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

    <h1>Student Marks Tracker</h1>
    <form id="studentForm">
        <label for="name">Student Name:</label>
        <input type="text" id="name" required><br>

        <label for="class">Class:</label>
        <input type="text" id="class" required><br>

        <label for="marks">Marks (separate with space, +, *, -, or ,):</label>
        <input type="text" id="marks" required><br>

        <button type="submit">Add Student</button>
    </form>

    <h2>Student Marks Tables</h2>
    <div id="tablesContainer"></div>

    <script>
        const studentForm = document.getElementById('studentForm');
        const tablesContainer = document.getElementById('tablesContainer');

        // Load the data from localStorage on page load
        document.addEventListener('DOMContentLoaded', loadStudentData);

        studentForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const classInput = document.getElementById('class').value;
            const marksInput = document.getElementById('marks').value;
            
            // Split marks by spaces, +, *, -, or commas and remove empty strings
            const marksArray = marksInput.split(/[\s\+\*\-,]+/).map(Number).filter(Boolean);
            const totalMarks = marksArray.reduce((acc, curr) => acc + curr, 0);

            const studentData = { name: name, totalMarks: totalMarks, class: classInput };
            
            // Get current data from localStorage or initialize as empty array
            let studentList = JSON.parse(localStorage.getItem('students')) || [];
            
            // Add the new student data to the list
            studentList.push(studentData);

            // Save updated list back to localStorage
            localStorage.setItem('students', JSON.stringify(studentList));

            // Refresh the tables to display updated data
            loadStudentData();

            // Clear the input fields
            document.getElementById('name').value = '';
            document.getElementById('class').value = '';
            document.getElementById('marks').value = '';
        });

        // Function to load student data from localStorage
        function loadStudentData() {
            // Retrieve data from localStorage
            const studentList = JSON.parse(localStorage.getItem('students')) || [];

            // Clear the current tables container
            tablesContainer.innerHTML = '';

            // Group students by class
            const groupedByClass = studentList.reduce((groups, student) => {
                const className = student.class;
                if (!groups[className]) {
                    groups[className] = [];
                }
                groups[className].push(student);
                return groups;
            }, {});

            // Create a table for each class
            for (const className in groupedByClass) {
                // Create table for the class
                const table = document.createElement('table');
                const headerRow = document.createElement('tr');
                const nameHeader = document.createElement('th');
                nameHeader.textContent = 'Student Name';
                const marksHeader = document.createElement('th');
                marksHeader.textContent = 'Total Marks';
                const actionHeader = document.createElement('th');
                actionHeader.textContent = 'Action';
                headerRow.appendChild(nameHeader);
                headerRow.appendChild(marksHeader);
                headerRow.appendChild(actionHeader);
                table.appendChild(headerRow);

                // Add each student in the class to the table
                groupedByClass[className].forEach((student, index) => {
                    const newRow = table.insertRow();
                    newRow.classList.add('highlight');

                    const nameCell = newRow.insertCell(0);
                    const marksCell = newRow.insertCell(1);
                    const actionCell = newRow.insertCell(2);

                    nameCell.textContent = student.name;
                    marksCell.textContent = student.totalMarks;

                    // Create a delete button for each row
                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Delete';
                    deleteButton.classList.add('delete-btn');
                    deleteButton.onclick = function() {
                        deleteStudent(index, student.class);
                    };
                    actionCell.appendChild(deleteButton);
                });

                // Add the table to the tables container
                const classHeader = document.createElement('h3');
                classHeader.textContent = `Class: ${className}`;
                tablesContainer.appendChild(classHeader);
                tablesContainer.appendChild(table);
            }
        }

        // Function to delete student from localStorage
        function deleteStudent(index, className) {
            // Retrieve current student data from localStorage
            let studentList = JSON.parse(localStorage.getItem('students')) || [];

            // Remove the student at the specified index from the right class
            const student = studentList.find(student => student.class === className);
            if (student) {
                studentList = studentList.filter((_, idx) => idx !== index);
            }

            // Save the updated list back to localStorage
            localStorage.setItem('students', JSON.stringify(studentList));

            // Refresh the tables after deletion
            loadStudentData();
        }
    </script>

</body>
</html>
